Aula API
API simples em Node.js/Express para gerenciar usuários (exemplo didático).

Autor: Hudson Neves

Resumo: Esta API expõe endpoints REST para listar, criar, atualizar e remover usuários armazenados em memória no arquivo server.js.

Pré-requisitos:

Node.js instalado (versão 12+ recomendada)
npm disponível
Instalação e execução

Instale dependências (se houver package.json):
npm install
Inicie o servidor:
node server.js
O servidor padrão roda em http://localhost:3000.

Endpoints

GET / : Health check

Resposta: JSON com mensagem, versão e timestamp
GET /usuarios : Lista todos os usuários

Resposta: { mensagem, data, total }
GET /usuarios/:id : Busca usuário por id

Resposta: { mensagem, data } ou 404 se não encontrado
POST /usuarios : Cria um novo usuário

Corpo (JSON): { "nome": "Nome Exemplo", "email": "email@exemplo.com" }
Validações: nome e email obrigatórios
Retorno: 201 Created com { mensagem, data } contendo o novo usuário
ID é gerado automaticamente a partir do maior id presente + 1
PUT /usuarios/:id : Atualiza usuário (substituição completa)

Corpo (JSON): { "nome": "Novo Nome", "email": "novo@exemplo.com" }
Retorna 400 se campos obrigatórios ausentes, 404 se usuário não encontrado
DELETE /usuarios/:id : Remove usuário por id

Retorno: { mensagem, data } com o usuário removido
Exemplos de requisições

PowerShell (recomendado no Windows - pwsh.exe):

# GET todos usuários
Invoke-RestMethod -Method Get -Uri http://localhost:3000/usuarios | ConvertTo-Json -Depth 3

# GET usuário por id
Invoke-RestMethod -Method Get -Uri http://localhost:3000/usuarios/1 | ConvertTo-Json -Depth 3

# POST novo usuário (JSON)
$body = @{ nome = 'Carlos Silva'; email = 'carlos@exemplo.com' } | ConvertTo-Json
Invoke-RestMethod -Method Post -Uri http://localhost:3000/usuarios -ContentType 'application/json' -Body $body

# PUT atualizar usuário
$body = @{ nome = 'Carlos Atualizado'; email = 'carlos.atual@exemplo.com' } | ConvertTo-Json
Invoke-RestMethod -Method Put -Uri http://localhost:3000/usuarios/3 -ContentType 'application/json' -Body $body

# DELETE usuário
Invoke-RestMethod -Method Delete -Uri http://localhost:3000/usuarios/3
Exemplo com curl (Linux/macOS / Git Bash / WSL):

# POST
curl -X POST http://localhost:3000/usuarios \
  -H "Content-Type: application/json" \
  -d '{"nome":"Carlos Silva","email":"carlos@exemplo.com"}'
Cabeçalhos importantes

Sempre envie Content-Type: application/json ao enviar JSON no POST/PUT.
Mensagens de log O server.js imprime logs simples no console para cada rota (ex.: POST /usuarios - Criando novo usuário). Verifique esses logs ao testar.

Possíveis problemas ao usar POST

Requisição sem Content-Type: application/json — o express.json() pode não interpretar corretamente o corpo.
Servidor não iniciado — verifique se node server.js está rodando sem erros.
Porta 3000 em uso por outro processo — verifique com netstat/Get-NetTCPConnection e libere ou altere a porta no server.js.
Body inválido (JSON malformado) — valide o JSON.
Como depurar rapidamente

Abra um terminal PowerShell e rode:
node server.js
Em outro terminal, rode um POST de teste (PowerShell):
$body = @{ nome = 'Teste'; email = 'teste@local' } | ConvertTo-Json
Invoke-RestMethod -Method Post -Uri http://localhost:3000/usuarios -ContentType 'application/json' -Body $body
Verifique o terminal onde o servidor roda para mensagens de log e possíveis erros.
Estrutura / comportamento do armazenamento

Os usuários são armazenados em um array em memória (usuarios em server.js). Isso significa:
Dados não persistem entre reinícios do servidor.
É apropriado apenas para demonstração / desenvolvimento.
Contribuição e melhorias sugeridas

Persistir dados em um banco (SQLite, MongoDB, etc.).
Adicionar validação mais robusta (ex.: express-validator).
Adicionar testes automatizados.
-- Arquivo principal: server.js

Se quiser, posso:

rodar o servidor e testar o POST localmente;
adicionar exemplos automáticos de teste (script npm test simples);
ou configurar persistência mínima (arquivo JSON) para não perder dados entre reinícios.
